<template>
    <div class="dragDropId">
        <!-- Header -->
        <div class="app-header">
            <h1>üöö Delivery Planning Dashboard</h1>
            <div class="header-actions">
                <button class="btn btn-secondary"><span>‚Üª</span>Refresh</button>
                <button class="btn btn-secondary"><span>üìä</span>Reports</button>
                <button class="btn btn-secondary"><span>‚öôÔ∏è</span>Settings</button>
            </div>
        </div>

        <!-- Toolbar for main page -->
        <div class="toolbar">
            <div class="filter-section left-side">
                <label>Customer:</label>
                <select>
                    <option value="all">All Customers</option>
                    <option value="KKB">KKB</option>
                    <option value="SKCN">SKCN</option>
                    <option value="PTT">PTT</option>
                    <option value="CSD">CSD</option>
                    <option value="BTA">BTA</option>
                    <option value="VCST">VCST</option>
                </select>
                <label>Product Type:</label>
                <select>
                    <option value="all">All Products</option>
                    <option value="DISC">DISC</option>
                    <option value="DOZER BLADE">DOZER BLADE</option>
                    <option value="PLOUGH">PLOUGH</option>
                    <option value="SCREW">SCREW</option>
                </select>

                <label>Week</label>
                <input type="week" value="2025-W47">

            </div>
            <!-- stats section part -->
            <div class="stats-section right-side">
                <div class=" stat-item">
                    <div class="stat-value">28</div>
                    <div class="stat-label">Pending</div>

                </div>
                <div class=" stat-item">
                    <div class="stat-value">42</div>
                    <div class="stat-label">Scheduled</div>
                </div>

                <div class=" stat-item">
                    <div class="stat-value">87%</div>
                    <div class="stat-label">Utilization</div>
                </div>

            </div>

        </div>

        <!-- Marker Capacity -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #0176d3;"></div>
                <span>Scheduled</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #2e844a;"></div>
                <span>Under Capacity</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ffa500;"></div>
                <span>Near Capacity</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #c23934;"></div>
                <span>At Capacity</span>
            </div>
        </div>


        <div class="scheduler-container">

            <!-- LEFT SIDE - ORDERS -->
            <div class="orders-panel">
                <div class="panel-header">
                    <h2>üìã Pending Fulfillments (28)</h2>
                    <button class="btn btn-success w-100">‚ú® AI Auto-Schedule Selected (2)</button>
                    <button class="btn btn-primary mt-4 w-100">Submit</button>
                </div>

                <template for:each={orders} for:item="o">
                    <div key={o.id} class="order-card" draggable="true" data-id={o.id} ondragstart={handleDragStart}>
                        <div class="order-id">{o.name}</div>
                        <div class="order-info">
                            {o.customer} - {o.productName} <br />
                            Quantity: {o.quantity}
                        </div>
                        <div class="order-weight">{o.weight} kg</div>
                    </div>
                </template>
            </div>

            <!-- RIGHT SIDE - CALENDAR -->
            <div class="calendar-panel">
                <template for:each={calendarData} for:item="day">
                    <div key={day.date} class="day-column">

                        <div class="day-header">
                            <div class="day-name">{day.dayName}</div>
                            <div class="day-date">{day.date}</div>
                        </div>

                        <template for:each={day.trucks} for:item="t">
                            <div key={t.truckId} class="truck-card" data-truck-id={t.truckId} data-date={day.date}
                                ondragover={handleDragOver} ondrop={handleDrop}>

                                <div class="truck-header">
                                    <div class="truck-name">Truck {t.truckId}</div>
                                    <div class="truck-capacity">{t.capacity} kg</div>
                                </div>

                                <div class="truck-orders">
                                    <template for:each={t.assignedOrders} for:item="ord">
                                        <div key={ord} class="assigned-order">
                                            FI-{ord}
                                        </div>
                                    </template>

                                    <template if:true={t.isEmpty}>
                                        <div class="empty-hint">Drop orders here</div>
                                    </template>
                                </div>

                            </div>
                        </template>
                    </div>
                </template>
            </div>

        </div>

    </div>
</template>